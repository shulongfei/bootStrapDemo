<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="stylesheet" href="../../../layuiadmin/layui/css/layui.css" media="all" />
	<link rel="stylesheet" href="../../../layuiadmin/style/admin.css" media="all" />
</head>
<body class="">
	<div class="layui-card">
		<div class="layui-card-body">
		    <form class="layui-form" style="width:80%">
		    		<div class="layui-form-item layui-row">
		    		<div class="layui-col-md5">
		    			<label class="layui-form-label neccesary">机构代码:</label>
							<div class="layui-input-block">
								<input id="orgNo" name="orgNo" class="layui-input" lay-verify="required">
								<input type="hidden" name="orgAuth" value="1"/>
								<input type="hidden" name="orgMode" value="0"/>
								<input type="hidden" name="delayFlag" value="0"/>
							</div>
		    		</div>
		    		<div class="layui-col-md5 layui-col-md-offset1">
		    			<label class="layui-form-label neccesary">机构名称:</label>
							<div class="layui-input-block">
								<input id="orgName" name="orgName" class="layui-input" lay-verify="required">
							</div>
		    		</div>
		    	</div>
		    	<div class="layui-form-item layui-row">
		    		<div class="layui-col-md5">
		    			<label class="layui-form-label neccesary">机构简称:</label>
							<div class="layui-input-block">
								<input id="orgShortName" name="orgShortName" class="layui-input" lay-verify="required"">
							</div>
		    		</div>
		    		<div class="layui-col-md5 layui-col-md-offset1">
		    			<label class="layui-form-label neccesary">英文简称:</label>
							<div class="layui-input-block">
								<input id="orgShortNameEn" name="orgShortNameEn" class="layui-input" lay-verify="required">
							</div>
		    		</div>
		    	</div>
		    	<div class="layui-form-item layui-row">
		    		<div class="layui-col-md5">
		    			<label class="layui-form-label neccesary">机构类型:</label>
		    			<div class="layui-input-block">
							<select id="orgType" name="orgType" lay-verify="required">
								<option value=""></option>
			                    <option value="01">银联</option>
			                    <option value="02">商户</option>
			                    <option value="03">银行</option>
			                </select>
		                </div>
		    		</div>
		    		<div class="layui-col-md5 layui-col-md-offset1">
		    			<label class="layui-form-label">机构状态:</label>
							<div class="layui-input-block">
								<select id="orgState" name="orgState" >
									<option value=""></option>
									<option value="1">启用</option>
									<option value="0">停用</option>
								</select>
							</div>
		    		</div>
		    	</div>
		    	<div class="layui-form-item layui-row">
		    		<div class="layui-col-md5">
		    			<label class="layui-form-label">联系人:</label>
							<div class="layui-input-block">
								<input id="orgMnger" name="orgMnger" class="layui-input">
							</div>
		    		</div>
		    		
		    	</div>
		    	<div class="layui-form-item ">
		    			<label class="layui-form-label">联系电话:</label>
							<div class="layui-input-block">
								<input id="orgTel" name="orgTel" class="layui-input">
							</div>
		    		</div>
		    	<div class="layui-form-item ">
		    		<div class="">
		    			<label class="layui-form-label">联系地址:</label>
							<div class="layui-input-block">
								<input id="orgAddr" name="orgAddr" class="layui-input">
							</div>
		    		</div>
		    	</div>
		    	<div class="layui-form-item layui-row">
		    		<div class="layui-col-md5">
		    			<label class="layui-form-label">邮政编码:</label>
							<div class="layui-input-block">
								<input id="orgZip" name="orgZip" class="layui-input">
							</div>
		    		</div>
		    		<!-- <div class="layui-col-md5 layui-col-md-offset1">
		    			<label class="layui-form-label">交易模式:</label>
							<div class="layui-input-block">
								<select id="orgMode" name="orgMode" lay-verify="required">
									<option value=""></option>
									<option value="0">非托管</option>
                    				<option value="1">托管</option>
								</select>
							</div>
		    		</div> -->
		    	</div>
		    <!-- 	<div class="layui-form-item layui-row">
		    		<div class="layui-col-md5">
		    			<label class="layui-form-label">计算滞纳金:</label>
						<div class="layui-input-block">
							<select id="delayFlag" name="delayFlag" >
								<option value=""></option>
								<option value="0">不计算</option>
                    			<option value="1">计算</option>
							</select>
						</div>
		    		</div>
		    		<div class="layui-col-md5 layui-col-md-offset1">
		    			<label class="layui-form-label">审核状态:</label>
						<div class="layui-input-block">
							<select id="verifyState" name="verifyState" >
								<option value=""></option>
								<option value="0">待审核</option>
			                    <option value="1">审核通过</option>
			                    <option value="2">审核未通过</option>
							</select>
						</div>
		    		</div>
		    	</div>
		    <div class="layui-form-item">
		    		<label class="layui-form-label">回退原因:</label>
					<div class="layui-input-block">
						<textarea id="verifyReason" name="verifyReason" placeholder="请输入回退原因" class="layui-textarea userDesc"></textarea>
					</div>
		    	</div> -->
				<div class="layui-input-block">
					<button type="button" class="layui-btn layui-btn-sm" lay-submit lay-filter="addOrg">立即添加</button>
					<button id="close" type="button" class="layui-btn layui-btn-sm layui-btn-primary">关闭</button>
			</div>
		     </form>
	   	</div>
</div>
<script type="text/javascript" src="../../../layuiadmin/layui/layui.js"></script>	
<script type="text/javascript">
layui.config({
		base:"../../../layuiadmin"
	}).extend({
		comExt:"/lib/comExt"
	}).use(['form','layer','comExt'], function(){
		var form = layui.form,
		layer = layui.layer,
		$ = layui.$,
		comExt = layui.comExt;
		/* $('button[lay-submit]').html("立即修改"); */
		//$('input[name=orgNo]').attr("readonly","readonly");//将input元素设置为readonly
		
		//提交新增/修改
	 	form.on("submit(addOrg)",function(data){
	 		var action = "/orgInfo/insertOrgInfo";//新增
	 		comExt.ajax({
	            url: action,
	            data: JSON.stringify(data.field),
	            success: function(o){
	            	console.log(o);
	            	if(o.success){
	            		var index = parent.layer.getFrameIndex(window.name);
		    	 		parent.layer.close(index);
		            	parent.location.reload();
		            	layer.msg("操作成功");
		            	return ; 
	            	}
	            	
                 }
       		 });
	 	});
		
	 	var disabled = true;
		$('form').on('change','input',function(){
			disabled = false;
		})
	 	$('#close').on('click',function(){
	 		var index = parent.layer.getFrameIndex(window.name);
	 		if(disabled){
		 		parent.layer.close(index);
	 		}else{
	 			layer.confirm("信息未提交，确认退出？",function(i){
		 			//当你在iframe页面关闭自身时
			 		parent.layer.close(index);
		 		})
	 		}
	 	})
	 	
		//清除
	 	layui.data("layer",null);
	  });
</script>
</body>
</html>